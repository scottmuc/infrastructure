# Adventures in Nix

## Nix Installation

After going down the path of following the official [Nix installer][official-nix-installer] a few times, I'm finally
ready to admit that the [Determinate Systems installer][determinate-installer]. I wanted to understand better why I
**shouldn't** use the official one. I read [their post][determinate-installer-post] and started to get a clearer
picture. Some of the major things I like are:

* The preview of the plan (and with extra details if you ask the installer to explain each step).
* The storage of a `/nix/receipt.json` which I find analogous to a terraform state file.
* A straightforward uninstall process. It's not compicated, but the steps for the
  [official nix uninstall instructions][official-nix-uninstall] definitely deterred me from starting from scratch
  several times.

To keep my Nix experience as vanilla as possible though, I'm not using the `--determinate` flag to the `install` command
of the installer.

[official-nix-installer]: https://nixos.org/download/
[official-nix-uninstall]: https://nix.dev/manual/nix/2.25/installation/uninstall.html
[determinate-installer]: https://github.com/DeterminateSystems/nix-installer
[determinate-installer-post]: https://determinate.systems/posts/determinate-nix-installer/

`/etc/nix/nix.conf` with `install --determinate`

```
# DETERMINATE NIX CONFIG
# do not modify! this file will be replaced!
# user modification can go in nix.custom.conf

!include nix.custom.conf

max-jobs = auto
bash-prompt-prefix = (nix:$name)\040
extra-experimental-features = nix-command flakes

netrc-file = /nix/var/determinate/netrc
post-build-hook = /nix/var/determinate/post-build-hook.sh

always-allow-substitutes = true
extra-substituters = https://cache.flakehub.com
extra-trusted-public-keys = cache.flakehub.com-3:hJuILl5sVK4iKm86JzgdXW12Y2Hwd5G07qKtHTOcDCM= cache.flakehub.com-4:Asi8qIv291s0aYLyH6IOnr5Kf6+OF14WVjkE6t3xMio= cache.flakehub.com-5:zB96CRlL7tiPtzA9/WKyPkp3A2vqxqgdgyTVNGShPDU= cache.flakehub.com-6:W4EGFwAGgBj3he7c5fNh9NkOXw0PUVaxygCVKeuvaqU= cache.flakehub.com-7:mvxJ2DZVHn/kRxlIaxYNMuDG1OvMckZu32um1TadOR8= cache.flakehub.com-8:moO+OVS0mnTjBTcOUh2kYLQEd59ExzyoW1QgQ8XAARQ= cache.flakehub.com-9:wChaSeTI6TeCuV/Sg2513ZIM9i0qJaYsF+lZCXg0J6o= cache.flakehub.com-10:2GqeNlIp6AKp4EF2MVbE1kBOp9iBSyo0UPR9KoR0o1Y=

upgrade-nix-store-path-url = https://install.determinate.systems/nix-upgrade/stable/universal

extra-nix-path = nixpkgs=flake:https://flakehub.com/f/DeterminateSystems/nixpkgs-weekly/*.tar.gz
```

`/etc/nix/nix.conf` without `install --determinate`

```
# Generated by https://github.com/DeterminateSystems/nix-installer.
# See `/nix/nix-installer --version` for the version details.

extra-experimental-features = nix-command flakes
auto-optimise-store = true
always-allow-substitutes = true
extra-trusted-substituters = https://cache.flakehub.com
extra-trusted-public-keys = cache.flakehub.com-3:hJuILl5sVK4iKm86JzgdXW12Y2Hwd5G07qKtHTOcDCM= cache.flakehub.com-4:Asi8qIv291s0aYLyH6IOnr5Kf6+OF14WVjkE6t3xMio= cache.flakehub.com-5:zB96CRlL7tiPtzA9/WKyPkp3A2vqxqgdgyTVNGShPDU= cache.flakehub.com-6:W4EGFwAGgBj3he7c5fNh9NkOXw0PUVaxygCVKeuvaqU= cache.flakehub.com-7:mvxJ2DZVHn/kRxlIaxYNMuDG1OvMckZu32um1TadOR8= cache.flakehub.com-8:moO+OVS0mnTjBTcOUh2kYLQEd59ExzyoW1QgQ8XAARQ= cache.flakehub.com-9:wChaSeTI6TeCuV/Sg2513ZIM9i0qJaYsF+lZCXg0J6o= cache.flakehub.com-10:2GqeNlIp6AKp4EF2MVbE1kBOp9iBSyo0UPR9KoR0o1Y=
bash-prompt-prefix = (nix:$name)\040
max-jobs = auto
extra-nix-path = nixpkgs=flake:nixpkgs
upgrade-nix-store-path-url = https://install.determinate.systems/nix-upgrade/stable/universal

!include nix.custom.conf
```


## Home Manager Installation

I'm still getting up to speed to modern things like `flakes` so I've opted for the
[standalone install][home-manager-install] of Home Manager. When the time comes, I'm sure I'll migrate to using `flakes`
but I'm not there yet.

[home-manager-install]: https://nix-community.github.io/home-manager/index.xhtml#sec-install-standalone

## Test Driving

I've altered my default shell on this laptop to `zsh`. To test drive `home-manager` and configurations I'll have it
configure `bash`. I've been considering ditching `zsh` since I don't really use any of its features. I only use it
because it became the default on macOS and I carried that over to Linux. [This Stackoverflow post][bash-vs-zsh]
confirmed that I don't use any of the futures so I might as well stick to something less fancy.

[bash-vs-zsh]: https://apple.stackexchange.com/questions/361870/what-are-the-practical-differences-between-bash-and-zsh
